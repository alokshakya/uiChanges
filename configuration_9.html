<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>TIA-700V</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="{{url_for('static', filename='Application/css/bootstrap.css') }}" rel="stylesheet" />
<link href="{{url_for('static', filename='Application/css/font-awesome.css') }}" rel="stylesheet">
<link href="{{url_for('static', filename='Application/css/global-style.css') }}" rel="stylesheet">

<script src="{{url_for('static', filename='Application/js/CircleChart.js') }}"></script>
<script type="text/javascript" src="{{url_for('static', filename='Application/js/common.js') }}"></script>


<style>
    #overlay {
      position: fixed;
      display: none;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0,0,0,0.6);
      z-index: 50;
      cursor: pointer;
    }
    
    #text{
      position: absolute;
      top: 50%;
      left: 50%;
      font-size: 20px;
      color: white;
      transform: translate(-50%,-50%);
      -ms-transform: translate(-50%,-50%);
    }

    .loaderOverlay {
    position: absolute;
    top: 80%;
    left: 35%;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid blue;
    border-bottom: 16px solid blue;
    width: 120px;
    height: 120px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
    }

    @-webkit-keyframes spin {
    0% { -webkit-transform: rotate(0deg); }
    100% { -webkit-transform: rotate(360deg); }
    }

    @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
    }

    /* for screen less than or eqaul to 600px below css*/
    @media screen and (max-width: 600px) { 
        #text{
            font-size:11px;
        }
        .loaderOverlay{
            top: 100%;
            left: 25%;
            border: 8px solid #f3f3f3;
            border-radius: 50%;
            border-top: 8px solid blue;
            border-bottom: 8px solid blue;
            width: 60px;
            height: 60px;
        }
    }
    </style>
</head>

<body onload="load()">
    <div id="overlay">
        <div id="text">
        <p>Reboot in progress.. Please wait..</p><br>
        <div class="loaderOverlay"></div>
        </div>
    </div>
    <div class="wrapper">

        <!----Header---->

 <header class="navbar navbar-default top-navbar" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#"><img src="{{url_for('static', filename='Application/imgs/tripwire-logo.png')}}" alt="Tripwire"></a>
            </div>
            <div class="tiaWrap" style="float: left;background: transparent;color: white;padding-top: 15px;">
                  Tripwire Industrial Appliance <br/><span class="tia700">TIA-700V</span>
            </div>

            <ul class="nav navbar-top-links pull-right">

                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false">
                        <i class="fa fa-user-circle"></i> <span id="logged-in-user"></span>  <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li><a onclick="factory_reset()"><i class="fa fa-user fa-fw"></i> Factory Reset</a></li>
                        <li><a onclick="reboot()"><i class="fa fa-gear fa-fw"></i> Reboot</a></li>
                        <li class="divider"></li>
                        <li><a onclick="logout()"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </header>

        <!----Left Navigation Sidebar---->
        <aside class="sidebar sidebar-collapse">
        <div class="navbar-default navbar-side">
          <ul class="nav" id="main-menu">
                    <li><a href="#" id="dBoard"><i class="fa fa-tachometer"></i></a></li>                  
                    <li><a href="#" class="active-menu"><i class="fa fa-microchip"></i></a></li>
                    <li><a href="#" id="sSettings"><i class="fa fa-cog"></i></a></li>
                </ul>                  
        </div>
        </aside>


        <!----Right Main Content---->
        <section class="page-wrapper">
            <div class="header">
                <h5 class="page-header">Device Configuration</h5>
            </div>

 <div class="page-inner">

<div id="parentTab">

    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#networkTab">Networking</a></li>    
    </ul>


    <div class="tab-content">
      <div id="networkTab" class="tab-pane fade in active">
        <div class="commonform" style="background:#fff;border-radius: 6px;border-top-left-radius: 0;border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;border-right: 1px solid #ddd;padding: 10px;">

<div id="childTabs">
    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#bridgeConfigTab">Bridge Configuration</a></li>
      <li onclick="getInterfaceList()"><a data-toggle="tab" href="#interFaceConfigTab">Interface Configuration</a></li>
      <li><a data-toggle="tab" href="#lbpTab">LAN Bypass</a></li>      
    </ul>

    <div class="tab-content">
      <div id="bridgeConfigTab" class="tab-pane fade in active">
        <div class="commonform" id="internalPorts" style="background:#fff;border-radius: 6px;border-top-left-radius: 0;border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;border-right: 1px solid #ddd;">
        </div>
      </div>

      <div id="interFaceConfigTab" class="tab-pane fade">
        <div class="commonform" style="background:#fff;border-radius: 6px;border-top-left-radius: 0;border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;border-right: 1px solid #ddd;">
          <div class="form-group col-xs-12 col-md-12" style="margin-bottom:5px;">
              <label class="control-label col-xs-12 col-sm-4 col-md-3">Interface List</label>
              <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                  <select id="interfaceSelect" onchange="interfaceChanged()" class="form-control display-inline" class="form-Select">
                      <!-- <option>E1</option>
                     <option>E2</option> -->
                  </select>
              </div>
          </div>                                      

          <div class="form-group col-xs-12 col-md-12">

              <label class="control-label col-xs-12 col-sm-4 col-md-3">IP Configuration</label>

              <div class="col-xs-12 col-sm-8 col-md-9">
                  <form id="ipConfig">
                  <input type="radio" name="interfaceRadio" id="interfaceRadioStatic" value="STATIC" onchange="enableDisable(value)" style="margin: 4px 9px 0px;">Static

                  <input type="radio" name="interfaceRadio" id="interfaceRadioDhcp" value="DHCP" onchange="enableDisable(value)" style="margin: 4px 9px 0px;">DHCP

                  <input type="radio" name="interfaceRadio" id="interfaceRadioNoip" value="NOIP" onchange="enableDisable(value)" style="margin: 4px 9px 0px;">NoIP
                      </form>
              </div>

          </div>

          <div class="form-group col-xs-12 col-md-12">

              <label class="control-label col-xs-12 col-sm-4 col-md-3">New IP</label>

              <div class="col-xs-12 col-sm-8 col-md-9 pb-5">

                  <input name="textInput" class="form-control" size="30" type="text"  id="newIP">

              </div>

              <label class="control-label col-xs-12 col-sm-4 col-md-3">Prefix</label>

              <div class="col-xs-12 col-sm-8 col-md-9 pb-5">

                  <input name="textInput" class="form-control" size="30" type="text"  id="prefix">

              </div>

              <label class="control-label col-xs-12 col-sm-4 col-md-3">Gateway</label>

              <div class="col-xs-12 col-sm-8 col-md-9 pb-5">

                      <input name="textInput" class="form-control" size="30" type="text"  id="gateway">

              </div>

                                                      
          </div>
          <div class="form-group col-xs-12 col-md-12">

              <label class="control-label col-xs-12 col-sm-4 col-md-3">&nbsp;</label>

              <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                  <div id="interfaceMessage"></div>
                  <button type="button" class="btn btn-primary" onclick="updateInterface()">Update</button>
              </div>

          </div>

        <div class="col-xs-12 col-md-12 col-sm-12">
          <div class="table-responsive">
                  <div class="fr"><button type="button" class="btn btn-primary" style="padding:3px 10px" onclick="renderTable()">Refresh</button></div>
                  <table class="gridtable table table-bordered">
                          <thead class="header">
                              <tr>
                                  <th>Name</th>
                                  <th>IP Address</th>
                                  <th>Netmask</th>
                                  <th>Status</th>
                                  <th>Type</th>        
                              </tr>
                          </thead>
                          <tbody id="tableBody">
                                  <!-- <tr class="rowpointer">
                                      <td class="nowrap">1</td>
                                      <td class="noaction">1</td>
                                      <td>10.20.100.8000</td>
                                      <td class="nowrap">09/28/2018 4:20:35 PM</td>
                                      <td></td>            
                                  </tr>             
                                  <tr class="rowpointer">
                                      <td class="nowrap">1</td>
                                      <td class="noaction">1</td>
                                      <td>10.20.100.8000</td>
                                      <td class="nowrap">09/28/2018 4:20:35 PM</td>
                                      <td></td>             
                                  </tr>                    -->
                          </tbody>
                          </table>
                      </div>
                    </div>

        </div>
      </div>      


      <div id="lbpTab" class="tab-pane fade">
        <div class="commonform" id="internalPorts" style="background:#fff;border-radius: 6px;border-top-left-radius: 0;border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;border-right: 1px solid #ddd;">
            <div class="form-group col-xs-12 col-md-12">                       
               <label class="control-label col-xs-12 col-sm-4 col-md-3">LAN Bypass</label>
               <div class="col-sm-9">
                  <input type="radio" name="lanByPass" value="enabled" id="radio1" style="margin: 4px 9px 0px;">Enable</input>

                  <input type="radio" name="lanByPass" value="disabled" id="radio2" style="margin: 4px 9px 0px;">Disable</input> 
              </div>
            <div id="messageLBP"></div>                
            </div>
            <div class="form-group col-xs-12 col-md-12">
                <label class="control-label col-xs-12 col-sm-4 col-md-3" for="email"></label>
                <div class="col-xs-12 col-sm-4 col-md-9">
                    <button type="button" class="btn btn-primary" onclick="updateLanbypass()">Update</button>
                </div>
            </div>                     
        </div>
      </div>

    </div>



</div>

        </div>
      </div>

</div>

</div>







        </section>
    </div>


    <script type="application/javascript">
    //document.getElementById("debugDownload").href = URL_PREFIX+ '/rest/v1/managers/logs' ;
//    document.getElementById("cUser").href=URL=URL_PREFIX + USER_PAGE_LOAD;
document.getElementById("sSettings").href=LOAD_SETTINGS;

document.getElementById("dBoard").href=URL_PREFIX + DASHBOARD_URI;
//document.getElementById("exportConfigDownload").href = URL_PREFIX +'/rest/v1/managers/actions/exportConfig' ;//+ DOWNLOAD_URI;
//document.getElementById("importConfigUpload").href=URL_PREFIX_FEATURE+'/rest/v1/managers/actions/importConfig';
 
    </script>

<script>
                function load(){
                    document.getElementById("logged-in-user").innerHTML = getCookie("userid");
                    internalPortsRender();
                    renderTable();
                    getLanbypass();
                    // Make sure to call lanbypass before interface else interface call will not work
                    getInterfaceList();

                    /*for interface list config */
                    document.getElementById('newIP').value= "" ;
                    document.getElementById('gateway').value= "" ;
                    document.getElementById('prefix').value= "" ;
                }


                function upload_image_form() {
                var form = document.getElementById('file-input-form');
                console.log('btn clicked form data upload');
                    var xhr = new XMLHttpRequest();
                    
                    var url='/rest/v1/managers/actions/importConfig';
                    //xhr.open('post', url, true);
                    xhr.open('post',url,false);
                    //xhr.setRequestHeader('Authorization',"Basic "+getBasicAuth());
                    xhr.withCredentials = true;
                    
                    var formData = new FormData(form);
                    
                    xhr.onload = function() {
                    //executed when request sending done and response received
                    console.log('xhr.status : '+xhr.status);
                        if(xhr.status == 200 || xhr.status == 201){
                           console.log(xhr.response);
                            resObj= JSON.parse(xhr.response);
                            console.log('success');
                            document.getElementById('messageUpload').innerHTML = `<p style="color:green">${resObj.message}</p>`;
                        }
                        else{
                           // console.log(xhr.response);

                            var resObj= JSON.parse(xhr.response);
                            console.log('failed');
                            console.log(resObj.message);
                            document.getElementById('messageUpload').innerHTML = `<p style="color:red">${resObj.message}</p>`;

                            
                        }
                    };

                    xhr.onerror = function() { // only triggers if the request couldn't be made at all
                    console.log(`Network Error`);
                    document.getElementById('messageUpload').innerHTML = '<p style="color:red">Network Error!!</p>';
                    };

                    xhr.upload.onprogress = function(e) {
                        var percentComplete = Math.ceil((e.loaded / e.total) * 100);
                        console.log('upload percentage : '+percentComplete);
                    };
                    
                    xhr.send(formData);
                
            };

                        //function for validating .rpm file extension in file upgrade upload

                        function validateRpm(){
                var ff = document.getElementById('file-upgrade');
                var filepath = ff.value;
                var allowedExtensions = /(\.rpm)$/i;
                if(!allowedExtensions.exec(filepath)){
                    alert('Please upload file having extension .rpm only.');
                    ff.value = '';
                    console.log('file upload format not supported');
                    return false;
                }
                console.log('file upload format supported');
                return true;

            };

            function upload_upgrade_form(){
                // function for upgrading file upload.
                console.log('upgrade upload file called');
                var form = document.getElementById('file-upgrade-form');
                
                var formData = new FormData(form);
                
                var ff = document.getElementById('file-upgrade');
                if( ff.value == ''){
                    console.log('empty form called');
                    alert('No file choosen .');
                    return;
                }
                console.log('form not empty');
                    var xhr = new XMLHttpRequest();
                    
                    var url='/rest/v1/software/actions/upgrade';
                    //xhr.open('post', url, true);
                    xhr.open('post',url,false);
                    //xhr.setRequestHeader('Authorization',"Basic " +getBasicAuth());
                    xhr.withCredentials = true;
                    
	
                    
                    xhr.onload = function() {
                    //executed when request sending done and response received
                    console.log('xhr.status : '+xhr.status);
                        if(xhr.status == 200 || xhr.status == 201){
                           // console.log(xhr.response);
                            console.log('success');
                            document.getElementById('messageUpgrade').innerHTML = '<p style="color:green">File Uploaded Successfully</p>';
                        }
                        else{
                           // console.log(xhr.response);
                            console.log('failed');
                            document.getElementById('messageUpgrade').innerHTML = '<p style="color:red">File Uploading Failed!!</p>';
                        }
                    };

                    xhr.onerror = function() { // only triggers if the request couldn't be made at all
                    console.log(`Network Error`);
                    document.getElementById('messageUpgrade').innerHTML = '<p style="color:red">Network Error!!</p>';
                    };

                    xhr.upload.onprogress = function(e) {
                        var percentComplete = Math.ceil((e.loaded / e.total) * 100);
                        console.log('upload percentage : '+percentComplete);
                    };
                    
                    xhr.send(formData);
            };

            function getRequest(url, requestName = "", callback){

                xhr = new XMLHttpRequest();
                //url = url;
                console.log(requestName + ' request sent : '+ url);
                
                xhr.onreadystatechange = function () {
                        if (xhr.readyState == XHR_DONE ){
                            if(xhr.status == HTTP_OK ){
                                console.log(requestName + ' request http ok');    
                            }}                         
                        else{
                            console.log(requestName + ' readyState :',xhr.readyState);
                        }}

                xhr.onload = function() {
                //executed when request sending done and response received
                console.log(requestName + ' xhr.status : '+xhr.status);
                let responseObj = xhr.response;
               // console.log(responseObj); 

                    if(xhr.status == 200 || xhr.status == 201){                           
                        console.log('success');
                        // Logic
                        callback(responseObj);
                       
                        // Logic end
                    }
                    else{
                        console.log(requestName + ' loading Failed!!');
                    }
                };

                xhr.onerror = function() { // only triggers if the request couldn't be made at all
                console.log(`Network Error`);
                document.getElementById('messageLBP').innerHTML = '<p style="color:red">Network Error!!</p>';
                };

                xhr.open("Get", url, true);
                xhr.withCredentials =  true;
                xhr.setRequestHeader("Content-Type", "application/json");
                //xhr.setRequestHeader('Authorization',"Basic "+getBasicAuth());
                xhr.responseType = 'json';
                xhr.send(); 
            }

            function postRequest(url, dat, requestName="", callback){
                console.log(requestName + ' port url :' + url);
                 //send xmlHttpRequest
                var xhr = new XMLHttpRequest();
                    
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == XHR_DONE ){
                        if(xhr.status == HTTP_OK ){
                            console.log(requestName + ' request http ok');    
                        }                        
                    }
                    else{
                        console.log(requestName + ' readyState :',xhr.readyState);
                    }

                }
                xhr.onload = function() {
                //executed when request sending done and response received
                console.log(requestName + ' xhr.status : '+xhr.status);
                let responseObj = xhr.response;
               // console.log(xhr.response);
                callback(xhr.status, responseObj);
                   /* if(xhr.status == 200 || xhr.status == 201){
                      
                    }
                    else{
                       
                    }*/
                };

                xhr.onerror = function() { // only triggers if the request couldn't be made at all
                    console.log(`Network Error`);
                };

                xhr.open('post',url,true);
                xhr.setRequestHeader('Content-Type','application/json');
                //xhr.setRequestHeader('Authorization',"Basic "+getBasicAuth());
                xhr.withCredentials = true;
                xhr.send(JSON.stringify(dat));
            }


            function getLanbypass(){

                console.log("anand get lanbypass");
                

                //console.log("anand url" + url);
                
                let xhr = new XMLHttpRequest();
                let url = "/rest/v1/network/config/lanbypass";
                console.log('url called :'+url);
                xhr.onload = function(){
                    console.log('xhr.status in LANBYPASSGET : '+xhr.status);
                    
                    if(xhr.status == 200 || xhr.status == 201){
                        console.log(xhr.response);
                        console.log('response in lanbypass success');
                        resObj = JSON.parse(xhr.response);
                        console.log(resObj);
                        var lanB = document.getElementsByName('lanByPass');
                        for(let i=0; i< lanB.length; i++){
                        
                        if(lanB[i].value == resObj.status){
                            lanB[i].checked = "checked";
                            console.log("Lan By Pass loaded Successfully");
                        }}
                    }
                    else{
                        console.log(xhr.response);
                        console.log('response in lanbypass failure');
                    }
                    

                };
                xhr.onerror = function(){
                    console.log('error occured in lanbypass');
                };

                //open request
                xhr.open('get',url,true);
                xhr.setRequestHeader('Content-Type','application/json');
                //xhr.setRequestHeader('Authorization',"Basic "+getBasicAuth());
                xhr.withCredentials = true;
                xhr.send();
                

             };

                 /* var lanB = document.getElementsByName('lanByPass');
                    for(let i=0; i< lanB.length; i++){
                    console.log(lanB[i].value);
                    console.log(responseObj.message);
                    if(lanB[i].value == "enabled"){
                        console.log("update lanByPass");
                        lanB[i].checked = "checked";
                     }}*/

            function updateLanbypass() {

                var url='/rest/v1/network/config/lanbypass';
                var lanB = document.getElementsByName('lanByPass');
                var dat = {};
                for(let i=0; i< lanB.length; i++){
                    if(lanB[i].checked){
                        console.log('checked value '+lanB[i].value);
                        dat.status = lanB[i].value;
                    }}    


                console.log('updateLanbypass dat :');
                console.log(dat);
                postRequest(url,dat, "LanByPassUpdate", function(status, responseObj){
                     responseObj = JSON.parse(responseObj);
                     if(status == 200 || status == 201){
                      //  console.log(responseObj);
                        console.log('success');
                        document.getElementById('messageLBP').innerHTML = '<p style="color:green">' + responseObj.message+ '</p>';
                    }
                    else{
                        console.log(responseObj);
                        console.log('failed');
                        document.getElementById('messageLBP').innerHTML = '<p style="color:red">' + responseObj.message + '</p>';
                    }

                });       
            };

            function updateInterface() {

                var interfaceName = document.getElementById('interfaceSelect').value;

                var form = document.getElementById("ipConfig");
                var rad = form.elements["interfaceRadio"].value;
                console.log(form.elements["interfaceRadio"].value);

                var url='/rest/v1/network/config/interface/' + interfaceName;

                 var dat ={};
                 //dat[interfaceName] = {};
                 dat["GATEWAY"] = document.getElementById('gateway').value ;
                 dat["IPADDR"] = document.getElementById('newIP').value ;
                 dat["IPCONFIGMODE"] = form.elements["interfaceRadio"].value;
                 dat["PREFIX"] = document.getElementById('prefix').value ;

                 console.log("interface dat" + dat);
                 console.log(dat);




              /*  var k='n';
                for(let key in obj){
                  //  console.log('key : '+key);
                    k='y';
                    dat['members'][`${key}`] = document.getElementById('members_'+key).value;
                }
                if(k == 'n'){
                    alert('no data to update ');
                    return;
                }
                var dat = {};
                "enp11s0": {
        "GATEWAY": "",
        "IPADDR": "",
        "IPCONFIGMODE": "DHCP",
        "PREFIX": ""
    },*/              

                postRequest(url,dat, "Interface update", function(status, resObj){
                     if(status == 200 || status == 201){
                      //  console.log(xhr.response);
                      resObj = JSON.parse(resObj);
                      // console.log("LBP ANAND" + xhr.response);
                        console.log('success');
                        document.getElementById('interfaceMessage').innerHTML = '<p style="color:green">' + resObj['message'] + '</p>';
                    }
                    else{
                       // console.log(xhr.response);
                       resObj = JSON.parse(resObj);
                        console.log('failed');
                        document.getElementById('interfaceMessage').innerHTML = '<p style="color:red">' + resObj['message'] + '</p>';
                    }

                });       
            };

             function updateMembers(obj){
                
                var dat={ members:{}};
                var k='n';
                for(let key in obj){
                  //  console.log('key : '+key);
                    k='y';
                    dat['members'][`${key}`] = document.getElementById('members_'+key).value;
                }
                if(k == 'n'){
                    alert('no data to update ');
                    return;
                }
                console.log('dat bridge : ' + dat);
                console.log(dat);
              //  console.log('stringify data');
              //  console.log('data '+JSON.stringify(dat));
                //now call api to update on server

             //calling api for response
              let url = 'rest/v1/network/config/bridge';
              postRequest(url, dat, "Update members", function(status,res){
                  if(status == 200 || status == 201){
                        console.log(res);
                        console.log('response in bridge configuration update success');
                        resObj = JSON.parse(res);
                        console.log(res);
                        document.getElementById('messageBridge').innerHTML = '<p style="color:green">' + resObj['message'] + '</p>';

                    }
                    else{
            resObj = JSON.parse(res);
                        console.log(res);
                        document.getElementById('messageBridge').innerHTML = '<p style="color:red">' + resObj['message'] + '</p>';

                    }                   

              })                
            };


            function internalPortsRender(){
                
                var internalPortsDoc = document.getElementById('internalPorts');
                var ht =``;
                ht +=`<div class="form-group col-xs-12 col-md-12">
                            <label class="control-label col-xs-12 col-sm-4 col-md-3"><b>Port</b></label>
                            <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                                <strong>Bridge</strong>
                            </div>
                        </div>`;
                var resObj=`{
                                "members": {
                                    "enp0s3": "true", 
                                    "enp0s8": "false", 
                                    "enp0s9": "false"
                                }
                            }`;

                resObj = JSON.parse(resObj);
                // for(let key in resObj['members'] ){
                //   //  console.log('key : '+key);
                //     ht +=`
                //     <div class="form-group col-xs-12 col-md-12" style="margin-bottom:5px;">
                //         <label class="control-label col-xs-12 col-sm-4 col-md-3">${key}</label>
                //         <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                //             <select id='members_${key}' class="form-control display-inline" class="form-Select">`;
                //                 if(resObj['members'][`${key}`] == "true"){
                //                     ht +=
                //                     `
                //                     <option value="true" selected>Yes</option>
                //                     <option value="false">No</option>
                //                     `;
                //                 }
                //                 else{
                //                     ht +=
                //                     `
                //                     <option value="true">Yes</option>
                //                     <option value="false" selected>No</option>
                //                     `;
                //                 }
                                
                //     ht +=
                //          `</select>
                //         </div>
                //     </div>`
                //     ;
                // }

                var objj = resObj['members'];
               // console.log('obj of members ');
              //  console.log(objj);
                var aa ={};
                aa = JSON.stringify(aa);
                objj = JSON.stringify(objj);
                ht +=`
                <div class="form-group col-xs-12 col-md-12">
                    <label class="control-label col-xs-12 col-sm-4 col-md-3">&nbsp;</label>
                    
                    <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                    <div id="messageBridge"></div>
                        <button type="button" class="btn btn-primary" onclick='updateMembers(${objj})'>Update</button>
                    </div>
                </div>
                `;

             internalPortsDoc.innerHTML = ht;

             //calling api for response
             let xhr = new XMLHttpRequest();
             let url = 'rest/v1/network/config/bridge';
             xhr.onload = function(){
                console.log('xhr.status : '+xhr.status);
                ht=``;
                ht +=`<div class="form-group col-xs-12 col-md-12">
                            <label class="control-label col-xs-12 col-sm-4 col-md-3"><b>Port</b></label>
                            <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                                <strong>Bridge</strong>
                            </div>
                        </div>`;
                if(xhr.status == 200 || xhr.status == 201){
                  //  console.log(xhr.response);
                  //  console.log('response in bridge get');
                    resObj = JSON.parse(xhr.response);
                    for(let key in resObj['members'] ){
                       // console.log('key members get : '+key);
                        ht +=`
                        <div class="form-group col-xs-12 col-md-12" style="margin-bottom:5px;">
                            <label class="control-label col-xs-12 col-sm-4 col-md-3" >${key}</label>
                            <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                                <select id='members_${key}' class="form-control display-inline" class="form-Select">`;
                                    if(resObj['members'][`${key}`] == "true"){
                                        ht +=
                                        `
                                        <option value="true" selected>Yes</option>
                                        <option value="false">No</option>
                                        `;
                                    }
                                    else{
                                        ht +=
                                        `
                                        <option value="true">Yes</option>
                                        <option value="false" selected>No</option>
                                        `;
                                    }
                                    
                        ht +=
                            `</select>
                            </div>
                        </div>`
                        ;
                    }
                    var ob = resObj['members'];
                   // console.log('ob object which will be passed in update');
                    ob = JSON.stringify(ob);
                   // console.log('ob str '+ob);

                    ht +=`
                            <div class="form-group col-xs-12 col-md-12">
                                <label class="control-label col-xs-12 col-sm-4 col-md-3">&nbsp;</label>
                                
                                <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                                <div id="messageBridge"></div>
                                    <button type="button" class="btn btn-primary" onclick='updateMembers(${ob})'>Update</button>
                                </div>
                            </div>
                            `;
                            internalPortsDoc.innerHTML = ht;
                }
                else{
                   // console.log(xhr.response);
                    ht +=`
                            <div class="form-group col-xs-12 col-md-12">
                                <label class="control-label col-xs-12 col-sm-4 col-md-3">&nbsp;</label>
                                
                                <div class="col-xs-12 col-sm-8 col-md-9 pb-5">
                                <div id="messageBridge"></div>
                                    <button type="button" class="btn btn-primary" onclick='updateMembers({})'>Update</button>
                                </div>
                            </div>
                            `;
                            internalPortsDoc.innerHTML = ht;
                    

                }
                

             };
             xhr.onerror = function(){
                console.log('network failure during get of bridge configuration');
             };

             //open request
             xhr.open('GET',url,true);
             xhr.withCredentials = true;
             xhr.send();


            };

            

            function renderTable(){
                var resObj = 
                    `{

                        "enp1s0": {

                            "ipaddress": "192.168.1.2", 

                            "netmask": "24", 

                            "status": "UP", 

                            "type": "Ethernet"

                        }, 

                        "enp2s0": {

                            "ipaddress": "192.168.1.3", 

                            "netmask": "24", 

                            "status": "DOWN", 

                            "type": "Ethernet"

                        }

                    }`;
                resObj = JSON.parse(resObj);
               // console.log('resObj');
               // console.log(resObj);
                var ka = Object.keys(resObj);
                //console.log('key length '+ka.length);
                    var ee = document.getElementById('tableBody');
                    var hhh =``;
                for(let key in resObj){
                   // console.log('key : '+key +' and status : '+resObj[`${key}`].status);
                    
                    hhh +=
                    `
                    <tr class="rowpointer">
                        <td class="nowrap">${key}</td>
                        <td class="noaction">${resObj[`${key}`].ipaddress}</td>
                        <td>${resObj[`${key}`].netmask}</td>
                        <td class="nowrap">${resObj[`${key}`].status}</td>
                        <td>${resObj[`${key}`].type}</td>            
                    </tr>
                    `;
                }
                //Testing Data commented
                //ee.innerHTML = hhh;

             //calling api for response
             let xhr = new XMLHttpRequest();
             let url = 'rest/v1/network/state/interface';
             xhr.onload = function(){
                console.log('xhr.status : '+xhr.status);
                if(xhr.status == 200 || xhr.status == 201){
                  //  console.log(xhr.response);
                    resObj = JSON.parse(xhr.response);
                  //  console.log('table draw res obj');
                  //  console.log(resObj);
                    var hhh =``;
                    for(let key in resObj){
                       // console.log('key : '+key +' and status : '+resObj[`${key}`].status);
                        
                        hhh +=
                        `
                        <tr class="rowpointer">
                            <td class="nowrap">${key}</td>
                            <td class="noaction">${resObj[`${key}`].ipaddress}</td>
                            <td>${resObj[`${key}`].netmask}</td>
                            <td class="nowrap">${resObj[`${key}`].status}</td>
                            <td>${resObj[`${key}`].type}</td>            
                        </tr>
                        `;
                    }
                    ee.innerHTML = hhh;
                   
                }
                else{
                  //  console.log(xhr.response);
                    console.log('interface api calling failed');
                    
                }

             };
             xhr.onerror = function(){
                console.log('error occured while fetching table data');
             };

             //open request
             xhr.open('GET',url,true);
             xhr.withCredentials = true;
             xhr.send();
            };

            function addRow(obj){
                obj={
                    name:"name ES",
                    ipaddress:'172.21.23.4',
                    netmask:18,
                    status:'UP',
                    type:'WiFi'
                };
                var ee = document.getElementById('tableBody');
                var ele = document.createElement('tr');
                    ele.classList.add('rowpointer');
                    ele.innerHTML = 
                    `
                    <td class="nowrap">${obj.name}</td>
                    <td class="noaction">${obj.ipaddress}</td>
                    <td>${obj.netmask}</td>
                    <td class="nowrap">${obj.status}</td>
                    <td>${obj.type}</td>
                    `;
                    ee.appendChild(ele);

            };

           


            var globalInterfaceVar;
                       
            function getInterfaceList(){
               // function getRequest(url, callback, requestName = ""){
               let url = '/rest/v1/network/config/bridge';
               getRequest(url,requestName = "Interface", function(responseObj){                    
                     //executed when request sending done and response received
                    //responseObj = JSON.stringify(responseObj);
                    globalInterfaceVar = responseObj;
                    var eee = document.getElementById('interfaceSelect');

                    ht=`<option value='br0' selected>br0</option>`;
                    for(let key in responseObj['members']){
                        ht +=`<option value='${key}'>${key}</option>`;
                    }
                    eee.innerHTML = ht;
                    //trueCondition();
                    brCondition();

               } );

              /*  var resObj=
                `{
                    "members":{
                        "esp1":"true",
                        "esp2":"false",
                        "esp3":"false",
                        "esp4":"true"
                    }
                }`; */

            };

            function interfaceChanged(){
                var val = document.getElementById('interfaceSelect').value;
                console.log('value selected '+val);

                console.log('global interface var ');
               // console.log(globalInterfaceVar);

                document.getElementById('newIP').value= "" ;
                document.getElementById('gateway').value= "" ;
                document.getElementById('prefix').value= "" ;


                if(val == "br0"){
                    brCondition();
                }
                else{
                    console.log('selected field val '+globalInterfaceVar['members'][`${val}`]);
                    if(globalInterfaceVar['members'][`${val}`] == "true"){
                        trueCondition();
                    }
                    else{
                        falseCondition();
                    }
                }
            };
            function brCondition() {
                 //disable NoIP radio button
                document.getElementById('interfaceRadioNoip').checked = false;
                document.getElementById('interfaceRadioDhcp').checked = false;
                document.getElementById('interfaceRadioStatic').checked = true;
                document.getElementById('interfaceRadioNoip').setAttribute('disabled','disabled');
                document.getElementById('interfaceRadioStatic').removeAttribute('disabled');
                document.getElementById('interfaceRadioDhcp').removeAttribute('disabled');
                enableText();
            }
            function trueCondition(){
                // select radio button NoIP automatically and disable other fields
                document.getElementById('interfaceRadioNoip').removeAttribute('disabled');
                document.getElementById('interfaceRadioNoip').checked = true;
                document.getElementById('interfaceRadioStatic').setAttribute('disabled','disabled');
                document.getElementById('interfaceRadioDhcp').setAttribute('disabled','disabled');
                disableText();

            };
            function falseCondition(){
                //disable NoIP radio button
                document.getElementById('interfaceRadioNoip').checked = false;
                document.getElementById('interfaceRadioDhcp').checked = false;
                document.getElementById('interfaceRadioStatic').checked = true;
                //document.getElementById('interfaceRadioNoip').checked = false;
                //document.getElementById('interfaceRadioNoip').setAttribute('disabled','disabled');
                document.getElementById('interfaceRadioStatic').removeAttribute('disabled');
                document.getElementById('interfaceRadioDhcp').removeAttribute('disabled');
                enableText();
            };

            function disableText(){
                //disable text input
                var dd = document.getElementsByName('textInput');
                for(let i=0; i< dd.length; i++){
                    dd[i].value ='';
                    dd[i].setAttribute('disabled','disabled');
                }
            };
            function enableText(){
                //enable text input
                var dd = document.getElementsByName('textInput');
                for(let i=0; i< dd.length; i++){
                    dd[i].removeAttribute('disabled');
                }
            };
            function enableDisable(value){
                console.log('enableDisable fun triggered ');
                console.log('value '+value);
                
                if(value =='STATIC'){
                    enableText();
                }
                else{
                    disableText();
                }
            };


        function changePwdPost() {

            var url=`rest/v1/users/${getUserName()}/actions/reset_password`;

            var newPWD = document.getElementById('nPwd').value;
            var cnfrmPWD = document.getElementById('cPwd').value;
                if(newPWD == DEF_PASSWD){
                    alert('Please choose a different password');
                    return false;
                }

                if (newPWD == '') {
                    //alert ("Please enter Password"); 
                      document.getElementById('messageValidationPWD').innerHTML = '<p style="color:red">Please enter Password</p>';
                      return false; 
                }
                // If confirm password not entered 
                else if (cnfrmPWD == '') {
                   // alert ("Please enter confirm password"); 
                       document.getElementById('messageValidationPWD').innerHTML = '<p style="color:red">Please enter confirm password</p>';
                       return false;
                }
                // If Not same return False.     
                else if (newPWD != cnfrmPWD) { 
                   // alert ("\nPassword did not match: Please try again...") 
                    document.getElementById('messageValidationPWD').innerHTML = '<p style="color:red">Password did not match: Please try again...</p>';
                    return false;
                } 
                else{ 
                    //alert("Password Match: Welcome to GeeksforGeeks!") 
                    document.getElementById('messageValidationPWD').innerHTML = '<p style="color:green">Password Match</p>';
                  
                } 


            var dat = {};
            dat.passwd = newPWD;
           
           console.log(dat);

            postRequest(url,dat, "changePassword", function(status,res){
                 if(status == 200 || status == 201){
                
                  //  console.log(xhr.response);
                    console.log('success');
                    resObj = JSON.parse(res);
                    document.getElementById('messagePWD').innerHTML = '<p style="color:green">' + resObj['message'] + '</p>';
                    localStorage.removeItem('user');
                    localStorage.removeItem('password');
                    window.location.href='/';//sending to login page
                }
                else{
                   // console.log(xhr.response);
                    console.log('failed');
                    resObj = JSON.parse(res);
                    document.getElementById('messagePWD').innerHTML = '<p style="color:red">' + xhr.response['message'] + '</p>';
                }
            });
        };

        function factory_reset(){
	    var url = "/rest/v1/managers/actions/resetToDefault";
	    var dat = {};
	    console.log('Going for Factory Reset');
	    console.log(dat);
	    postRequest(url,dat, "FactoryReset", function(status, responseObj){
		if(status == 200 || status == 201){
			responseObj = JSON.parse(responseObj);
			alert("Factory Reset Successful");
		}
		else {
		    console.log(responseObj);
		}
            });
        };
        
        function getUserName(){
            //return localStorage.getItem('user');
                return getCookie("userid");
        };
        function getPassword(){
            return localStorage.getItem('password');
        };

        function getBasicAuth(){
            var a = window.btoa(`${getUserName()}:${getPassword()}`);
            return a;
        };

        function reboot()
        {
            console.log('Going for Reboot....');
                let xhr = new XMLHttpRequest();
                let url = "/rest/v1/managers/actions/reboot";;
                console.log('url called :'+url);
                xhr.onload = function(){
                    console.log('xhr.status in reboot : '+xhr.status);

                };
                xhr.onerror = function(){
                    console.log('error occured in lanbypass');
                };

                //open request
                xhr.open('POST',url,true);
                xhr.setRequestHeader('Content-Type','application/json');
                //xhr.setRequestHeader('Authorization',"Basic "+getBasicAuth());
                xhr.withCredentials = true;
                xhr.send(JSON.stringify({}));

                // display overlay screen
                document.getElementById('overlay').style.display = 'block';
                setTimeout(function(){
                    console.log('Timer has expired so redirected the page');
                    document.getElementById('overlay').style.display = 'none';
                    window.location.href = '/';
                }, 60000);
	};

        function logout()
	{
	    alert("going to logout");
	    var url = `/rest/v1/session/${getUserName()}/actions/delete`;
	    console.log('Logging out the current user');
	    var dat = {};
	    postRequest(url,dat, "Logout", function(status,res){
	        if (status==200 || status ==201)
	        {
		    console.log('success');
		    //resObj = JSON.parse(res);
            localStorage.removeItem('user');
            localStorage.removeItem('password');
		    window.location.href='/';//sending to login page
                }
                else {
                    console.log('failed');
                    resObj = JSON.parse(res);
                    console.log(res);
		            alert(resObj.message);
	        }
            });
    };

function getCookie(cname) {
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i <ca.length; i++) {
     var c = ca[i];
     while (c.charAt(0) == ' ') {
        c = c.substring(1);
     }
     if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
     }
  }  
  return "";
};



</script>




<script src="{{url_for('static', filename='Application/js/jquery-2.1.1.min.js') }}"></script>
<script src="{{url_for('static', filename='Application/js/bootstrap.min.js') }}"></script>
<script src="{{url_for('static', filename='Application/js/jquery.metisMenu.js') }}"></script>
<script src="{{url_for('static', filename='Application/js/custom-scripts.js') }}"></script>

</body>
</html>
